function generateNumber(){for(var e=Math.floor(16*Math.random());;){if(0==a[e])break;e=Math.floor(16*Math.random())}rand=Math.random(),a[e]=rand<.9?2:4}function show(){for(var e=document.getElementById("game2048"),r=0;r<a.length;r++)e.appendChild(createDiv(r,a[r]))}function createDiv(e,r){var a=document.createElement("div");return a.id=e,0!=r?(a.innerHTML=r,a.style.backgroundColor=bgcolors[Math.log(r)/Math.log(2)],a.style.color=r<8?colors[0]:colors[1]):a.style.backgroundColor=bgcolors[0],a}function clean(){var e=document.getElementById("game2048");for(i=0;i<a.length;i++){var r=document.getElementById(i);e.removeChild(r)}}function check(){if(-1==a.indexOf(0)){for(var e=0;e<a.length;e++)if(e+1<a.length&&a[e]==a[e+1]&&e%4!=3||e+4<a.length&&a[e]==a[e+4])return!1;return!0}return!1}function eatZero(e){for(var r=e.length;r>=0;r--)0==e[r]&&e.splice(r,1);return e}function MoveAndMerge(e){e=eatZero(e);for(var r=0;r<e.length-1;r++)e[r]==e[r+1]&&(e[r]*=2,e[r+1]=0);e=eatZero(e);for(var a=4-e.length,r=0;r<a;r++)e.push(0);return e}function getMove(e){switch(clean(),e){case 38:for(var r=0;r<4;r++){for(var o=new Array(4),n=0;n<4;n++)o[n]=a[r+4*n];o=MoveAndMerge(o);for(var n=0;n<4;n++)a[r+4*n]=o[n]}break;case 40:for(var r=0;r<4;r++){for(var o=new Array(4),n=0;n<4;n++)o[3-n]=a[r+4*n];o=MoveAndMerge(o);for(var n=0;n<4;n++)a[r+4*n]=o[3-n]}break;case 37:for(var r=0;r<4;r++){for(var t=new Array(4),n=0;n<4;n++)t[n]=a[4*r+n];t=MoveAndMerge(t);for(var n=0;n<4;n++)a[4*r+n]=t[n]}break;case 39:for(var r=0;r<4;r++){for(var t=new Array(4),n=0;n<4;n++)t[3-n]=a[4*r+n];t=MoveAndMerge(t);for(var n=0;n<4;n++)a[4*r+n]=t[3-n]}}if(-1!=a.indexOf(2048)){show();var c=document.createElement("section");c.innerHTML="You Win!",c.style.backgroundColor="rgba(245, 124, 95, 0.3)",document.getElementById("game2048").appendChild(c)}else if(-1!=a.indexOf(0)&&generateNumber(),show(),check()){var c=document.createElement("section");c.innerHTML="Game Over!",c.style.backgroundColor="rgba(0, 0, 0, 0.3)",document.getElementById("game2048").appendChild(c)}}for(var bgcolors=["#ccc0b2","#eee4da","#ece0c8","#f2b179","#f59563","#f57c5f","#f65d3b","#edce71","#edcc61","#ecc850","#edc53f","#eec22e"],colors=["#7c736a","#fff7eb"],a=new Array(16),i=0;i<a.length;i++)a[i]=0;window.onload=function(){generateNumber(),generateNumber(),show(),window.addEventListener("keydown",function(e){37!=e.keyCode&&38!=e.keyCode&&39!=e.keyCode&&40!=e.keyCode||0==document.getElementsByTagName("section").length&&getMove(e.keyCode)})};